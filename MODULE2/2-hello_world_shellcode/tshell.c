/*
A simple program to test shellcode
gcc -fno-stack-protector -z execstack tshell.c
*/

#include <stdio.h>
#include <string.h>

unsigned char code[]= \
"\xeb\x17\x31\xc0\xb0\x04\x31\xdb\xb3\x01\x59\x31\xd2\xb2\x2f\xcd\x80\x31\xc0\xb0"
"\x01\x31\xdb\xcd\x80\xe8\xe4\xff\xff\xff\x42\x6c\x61\x63\x6b\x20\x58\x36\x2c\x20"
"\x50\x68\x61\x6e\x74\x6f\x6d\x2c\x20\x57\x68\x69\x74\x65\x20\x58\x36\x20\x6c\x6f"
"\x6f\x6b\x73\x20\x6c\x69\x6b\x65\x20\x61\x20\x50\x61\x6e\x64\x61\x0a";

main()
{
	printf("Shellcode Length: %d\n", strlen(code));
	int (*ret)() = (int(*)())code;
	ret();
}

